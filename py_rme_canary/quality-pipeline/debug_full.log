+ set -Eeuo pipefail
+ export PYTHONUTF8=1
+ PYTHONUTF8=1
+ export TERM=xterm-256color
+ TERM=xterm-256color
+ PYTHON_BIN=python
++ pwd
+ ROOT_DIR='/c/Users/Marcelo Henrique/Desktop/projec_rme/py_rme_canary/quality-pipeline'
+++ dirname quality.sh
++ cd .
++ pwd
+ SCRIPT_DIR='/c/Users/Marcelo Henrique/Desktop/projec_rme/py_rme_canary/quality-pipeline'
++ cd '/c/Users/Marcelo Henrique/Desktop/projec_rme/py_rme_canary/quality-pipeline/../tools/quality_scripts'
++ pwd
+ QUALITY_SCRIPTS_DIR='/c/Users/Marcelo Henrique/Desktop/projec_rme/py_rme_canary/tools/quality_scripts'
+ REPORT_DIR=.quality_reports
+ TMP_DIR=.quality_tmp
+ CACHE_DIR=.quality_cache
+ SYMBOL_INDEX_BEFORE=.quality_reports/symbols_before.json
+ SYMBOL_INDEX_AFTER=.quality_reports/symbols_after.json
+ ISSUES_NORMALIZED=.quality_reports/issues_normalized.json
+ FINAL_REPORT=.quality_reports/refactor_summary.md
++ date +%Y%m%d_%H%M%S
+ LOG_FILE=.quality_reports/quality_20260122_163844.log
+ RUFF_CONFIG=pyproject.toml
+ MYPY_CONFIG=pyproject.toml
+ RADON_CC_THRESHOLD=10
+ RADON_MI_THRESHOLD=20
+ MODE=dry-run
+ SKIP_TESTS=false
+ SKIP_LIBCST=false
+ SKIP_SONAR=false
+ VERBOSE=false
+ ENABLE_TELEMETRY=false
+ PARALLEL_AVAILABLE=false
+ readonly 'RED=\033[0;31m'
+ RED='\033[0;31m'
+ readonly 'GREEN=\033[0;32m'
+ GREEN='\033[0;32m'
+ readonly 'YELLOW=\033[1;33m'
+ YELLOW='\033[1;33m'
+ readonly 'BLUE=\033[0;34m'
+ BLUE='\033[0;34m'
+ readonly 'CYAN=\033[0;36m'
+ CYAN='\033[0;36m'
+ readonly 'NC=\033[0m'
+ NC='\033[0m'
+ [[ 0 -gt 0 ]]
+ mkdir -p .quality_reports .quality_tmp .quality_cache
+ command -v uv
+ PYTHON_INSTALL_CMD='uv pip install'
+ log INFO 'Usando uv (fast mode)'
+ local level=INFO
+ local 'message=Usando uv (fast mode)'
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ echo -e '\033[0;36m[INFO]\033[0m  [2026-01-22 16:38:44] Usando uv (fast mode)'
+ tee -a .quality_reports/quality_20260122_163844.log
[0;36m[INFO][0m  [2026-01-22 16:38:44] Usando uv (fast mode)
+ [[ false == true ]]
++ date +%s
+ ROLLBACK_STASH=quality-rollback-1769110724
+ ROLLBACK_COMMIT=
+ ROLLBACK_ACTIVE=false
+ trap rollback ERR
+ main
+ log INFO '=== Quality Pipeline Iniciado ==='
+ local level=INFO
+ local 'message==== Quality Pipeline Iniciado ==='
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ echo -e '\033[0;36m[INFO]\033[0m  [2026-01-22 16:38:44] === Quality Pipeline Iniciado ==='
+ tee -a .quality_reports/quality_20260122_163844.log
[0;36m[INFO][0m  [2026-01-22 16:38:44] === Quality Pipeline Iniciado ===
+ [[ false == true ]]
+ log INFO 'Modo: dry-run | Verbose: false | Telemetry: false'
+ local level=INFO
+ local 'message=Modo: dry-run | Verbose: false | Telemetry: false'
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ echo -e '\033[0;36m[INFO]\033[0m  [2026-01-22 16:38:44] Modo: dry-run | Verbose: false | Telemetry: false'
+ tee -a .quality_reports/quality_20260122_163844.log
[0;36m[INFO][0m  [2026-01-22 16:38:44] Modo: dry-run | Verbose: false | Telemetry: false
+ [[ false == true ]]
+ check_dependencies
+ log INFO 'Verificando dependÃªncias do sistema...'
+ local level=INFO
+ local 'message=Verificando dependÃªncias do sistema...'
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ echo -e '\033[0;36m[INFO]\033[0m  [2026-01-22 16:38:44] Verificando dependÃªncias do sistema...'
+ tee -a .quality_reports/quality_20260122_163844.log
[0;36m[INFO][0m  [2026-01-22 16:38:44] Verificando dependÃªncias do sistema...
+ [[ false == true ]]
+ local missing=0
+ require python 'pip install python'
+ local cmd=python
+ local 'install_hint=pip install python'
+ command -v python
++ command -v python
+ log DEBUG 'python encontrado: /c/Python312/python'
+ local level=DEBUG
+ local 'message=python encontrado: /c/Python312/python'
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ [[ false == true ]]
+ [[ false == true ]]
+ return 0
+ require ruff 'pip install ruff'
+ local cmd=ruff
+ local 'install_hint=pip install ruff'
+ command -v ruff
+ command -v ruff.exe
+ log ERROR 'Dependencia ausente: ruff'
+ local level=ERROR
+ local 'message=Dependencia ausente: ruff'
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ echo -e '\033[0;31m[ERROR]\033[0m [2026-01-22 16:38:44] Dependencia ausente: ruff'
+ tee -a .quality_reports/quality_20260122_163844.log
[0;31m[ERROR][0m [2026-01-22 16:38:44] Dependencia ausente: ruff
+ [[ false == true ]]
+ [[ -n pip install ruff ]]
+ log INFO 'Sugestao de instalacao: pip install ruff'
+ local level=INFO
+ local 'message=Sugestao de instalacao: pip install ruff'
+ local timestamp
++ date '+%Y-%m-%d %H:%M:%S'
+ timestamp='2026-01-22 16:38:44'
+ case "$level" in
+ echo -e '\033[0;36m[INFO]\033[0m  [2026-01-22 16:38:44] Sugestao de instalacao: pip install ruff'
+ tee -a .quality_reports/quality_20260122_163844.log
[0;36m[INFO][0m  [2026-01-22 16:38:44] Sugestao de instalacao: pip install ruff
+ [[ false == true ]]
+ return 1
+ (( missing++ ))
++ rollback
++ [[ false == false ]]
++ log WARN 'Nenhum snapshot ativo para rollback'
++ local level=WARN
++ local 'message=Nenhum snapshot ativo para rollback'
++ local timestamp
+++ date '+%Y-%m-%d %H:%M:%S'
++ timestamp='2026-01-22 16:38:45'
++ case "$level" in
++ echo -e '\033[1;33m[WARN]\033[0m  [2026-01-22 16:38:45] Nenhum snapshot ativo para rollback'
++ tee -a .quality_reports/quality_20260122_163844.log
[1;33m[WARN][0m  [2026-01-22 16:38:45] Nenhum snapshot ativo para rollback
++ [[ false == true ]]
++ return 0
