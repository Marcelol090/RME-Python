============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
PyQt6 6.10.2 -- Qt runtime 6.10.2 -- Qt compiled 6.10.0
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /app
configfile: pyproject.toml
plugins: cov-7.0.0, qt-4.5.0, benchmark-5.2.3
collected 60 items

py_rme_canary/tests/unit/vis_layer/ui/test_overlays.py .............     [ 21%]
py_rme_canary/tests/unit/vis_layer/ui/test_widgets.py .................. [ 51%]
.                                                                        [ 53%]
py_rme_canary/tests/unit/vis_layer/ui/test_dialogs.py .................. [ 83%]
...                                                                      [ 88%]
py_rme_canary/tests/unit/core/io/test_lua_creature_import.py ...         [ 93%]
py_rme_canary/tests/unit/logic_layer/operations/test_map_import.py .     [ 95%]
py_rme_canary/tests/unit/core/protocols/test_tile_serializer.py F..      [100%]

=================================== FAILURES ===================================
____________________ test_tile_update_roundtrip_single_tile ____________________

    def test_tile_update_roundtrip_single_tile() -> None:
        tile = Tile(
            x=10,
            y=20,
            z=7,
            ground=Item(id=100),
            items=[Item(id=200, subtype=3)],
            house_id=5,
            map_flags=4,
        )

        payload = encode_tile_update([tile])
        tiles, ok = decode_tile_update(payload)

        assert ok is True
        assert len(tiles) == 1
        decoded = tiles[0]
        assert decoded["x"] == 10
        assert decoded["y"] == 20
        assert decoded["z"] == 7
        assert decoded["ground_id"] == 100
        assert decoded["house_id"] == 5
>       assert decoded["flags"] == 4
E       assert 3 == 4

py_rme_canary/tests/unit/core/protocols/test_tile_serializer.py:30: AssertionError
=========================== short test summary info ============================
FAILED py_rme_canary/tests/unit/core/protocols/test_tile_serializer.py::test_tile_update_roundtrip_single_tile
========================= 1 failed, 59 passed in 1.79s =========================
